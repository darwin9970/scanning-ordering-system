# 桌台扫码点单系统 - 项目结构文档

## 一、项目概览

本项目包含两个主要子项目：

| 项目 | 技术栈 | 目录 | 端口 |
|:---|:---|:---|:---|
| **后台管理系统** | Next.js 16 + TailwindCSS | `/admin` | 3000 |
| **API 服务** | Elysia + Drizzle + Redis | `/api` | 4000 |

## 二、目录结构

### 2.1 API 服务 (`/api`)

```
api/
├── src/
│   ├── index.ts           # 入口文件，Elysia 应用配置
│   ├── db/
│   │   ├── schema.ts      # Drizzle 数据模型定义
│   │   └── index.ts       # 数据库连接
│   ├── lib/
│   │   ├── redis.ts       # Redis 客户端配置
│   │   └── utils.ts       # 工具函数
│   ├── routes/
│   │   ├── auth.ts        # 认证路由
│   │   ├── stores.ts      # 门店管理
│   │   ├── tables.ts      # 桌台管理
│   │   ├── categories.ts  # 分类管理
│   │   ├── products.ts    # 商品管理
│   │   ├── orders.ts      # 订单管理
│   │   ├── printers.ts    # 打印机管理
│   │   ├── dashboard.ts   # 数据看板
│   │   ├── staff.ts       # 员工管理
│   │   └── settings.ts    # 系统设置
│   ├── ws/                # WebSocket 模块
│   └── worker/            # 打印 Worker
├── scripts/
│   └── seed.ts            # 数据库种子脚本
├── .env.example           # 环境变量示例
├── package.json
└── tsconfig.json
```

### 2.2 后台管理系统 (`/admin`)

```
admin/
├── app/                       # App Router 页面
│   ├── layout.tsx             # 根布局
│   ├── page.tsx               # 首页（重定向到 dashboard）
│   ├── login/
│   │   └── page.tsx           # 登录页
│   └── dashboard/
│       ├── layout.tsx         # 后台布局
│       ├── page.tsx           # 数据概览
│       ├── orders/            # 订单管理
│       ├── products/          # 商品管理
│       ├── categories/        # 分类管理
│       ├── tables/            # 桌台管理
│       ├── printers/          # 打印机配置
│       ├── stores/            # 门店管理
│       ├── reports/           # 数据报表
│       ├── staff/             # 员工管理
│       └── settings/          # 系统设置
├── components/
│   ├── ui/                    # 基础 UI 组件
│   │   ├── button.tsx
│   │   ├── input.tsx
│   │   ├── card.tsx
│   │   ├── badge.tsx
│   │   ├── dialog.tsx
│   │   ├── table.tsx
│   │   ├── label.tsx
│   │   ├── select.tsx
│   │   ├── textarea.tsx
│   │   └── switch.tsx
│   ├── layout/                # 布局组件
│   │   ├── sidebar.tsx
│   │   ├── header.tsx
│   │   └── dashboard-layout.tsx
│   └── providers.tsx          # React Query Provider
├── lib/
│   ├── api.ts                 # API 客户端
│   ├── utils.ts               # 工具函数
│   ├── validations.ts         # 表单校验 (zod)
│   └── websocket.ts           # WebSocket Hook
├── store/
│   └── auth.ts                # Zustand 认证状态
├── types/
│   └── index.ts               # TypeScript 类型定义
├── package.json
└── tsconfig.json
```

## 三、技术栈详情

### 3.1 后端技术栈

| 技术 | 版本 | 用途 |
|:---|:---|:---|
| Elysia | 1.4.x | 高性能 API 框架 |
| Drizzle | 0.44.x | ORM，类型安全 |
| ioredis | 5.x | Redis 客户端 |
| @elysiajs/jwt | 1.4.x | JWT 认证 |
| @elysiajs/swagger | 1.3.x | API 文档 |
| @elysiajs/cors | 1.4.x | 跨域支持 |

### 3.2 前端技术栈

| 技术 | 版本 | 用途 |
|:---|:---|:---|
| Next.js | 16.x | React 框架 |
| TailwindCSS | 4.x | CSS 框架 |
| @tanstack/react-query | 5.x | 数据请求 |
| Zustand | 5.x | 状态管理 |
| Radix UI | 各组件 | 无障碍 UI 原语 |
| Lucide React | 0.5x | 图标库 |
| Recharts | 3.x | 图表库 |

## 四、启动指南

### 4.1 环境准备

1. 安装 Bun 运行时
2. 准备 PostgreSQL 16+ 数据库
3. 准备 Redis 7.0+ 服务

### 4.2 API 服务启动

```bash
cd api

# 1. 安装依赖
bun install

# 2. 配置环境变量
cp .env.example .env
# 编辑 .env 文件，配置数据库和 Redis 连接

# 3. 初始化数据库
bun run db:push

# 4. 播种测试数据
bun run db:seed

# 5. 启动开发服务器
bun run dev
```

### 4.3 后台管理系统启动

```bash
cd admin

# 1. 安装依赖
bun install

# 2. 启动开发服务器
bun run dev
```

### 4.4 访问地址

- **后台管理系统**: http://localhost:3000
- **API 服务**: http://localhost:4000
- **API 文档**: http://localhost:4000/swagger

### 4.5 测试账号

- 用户名: `admin`
- 密码: `admin123`

## 五、开发规范

### 5.1 代码风格

- 使用 TypeScript 强类型
- 组件使用函数式组件 + Hooks
- API 路由按模块组织
- 使用 Drizzle ORM 进行数据库操作

### 5.2 Git 提交规范

```
feat: 新功能
fix: 修复 bug
docs: 文档更新
style: 代码格式
refactor: 重构
test: 测试
chore: 构建/工具
```

## 六、下一步计划

- [x] 完善打印 Worker 服务
- [x] 实现 WebSocket 实时通信
- [x] 实现员工管理功能
- [x] 实现系统设置功能
- [ ] 开发小程序端
- [ ] 对接微信支付
- [ ] 部署到生产环境
